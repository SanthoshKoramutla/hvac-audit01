<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AirPro HVAC â€“ Comfort You Can Count On</title>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --navy: #0a1628;
      --cyan: #00c9d4;
      --amber: #f59e0b;
      --white: #ffffff;
      --gray: #64748b;
      --light: #f1f5f9;
      --text: #1e293b;
    }

    html { scroll-behavior: smooth; }
    body { font-family: 'DM Sans', sans-serif; background: var(--navy); color: var(--white); overflow-x: hidden; }

    /* â”€â”€â”€ NAV â”€â”€â”€ */
    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 100;
      display: flex; align-items: center; justify-content: space-between;
      padding: 1.2rem 6%;
      background: rgba(10,22,40,0.88); backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0,201,212,0.15);
    }
    .logo { font-family: 'Syne', sans-serif; font-weight: 800; font-size: 1.5rem; color: var(--cyan); }
    .logo span { color: var(--white); }
    .nav-links { display: flex; gap: 2rem; list-style: none; }
    .nav-links a { color: rgba(255,255,255,0.72); text-decoration: none; font-size: 0.9rem; transition: color .2s; }
    .nav-links a:hover { color: var(--cyan); }
    .nav-cta { background: var(--cyan); color: var(--navy); padding: .55rem 1.4rem; border-radius: 6px; font-weight: 700; font-size: .85rem; text-decoration: none; }
    .nav-cta:hover { background: #00b5bf; }
    @media(max-width:640px){ .nav-links { display:none; } }

    /* â”€â”€â”€ HERO â”€â”€â”€ */
    .hero { min-height: 100vh; display: flex; flex-direction: column; justify-content: center; padding: 7rem 6% 4rem; position: relative; overflow: hidden; }
    .hero-bg { position: absolute; inset: 0; background: radial-gradient(ellipse 80% 60% at 70% 50%, rgba(0,201,212,.12) 0%, transparent 70%), linear-gradient(135deg,#0a1628,#0d1f3c); }
    .hero-grid { position: absolute; inset: 0; opacity: .04; background-image: linear-gradient(rgba(0,201,212,1) 1px,transparent 1px), linear-gradient(90deg,rgba(0,201,212,1) 1px,transparent 1px); background-size: 60px 60px; }
    .hero-content { position: relative; max-width: 620px; }
    .badge { display:inline-flex; align-items:center; gap:.5rem; background:rgba(0,201,212,.12); border:1px solid rgba(0,201,212,.3); color:var(--cyan); padding:.4rem 1rem; border-radius:100px; font-size:.8rem; font-weight:500; margin-bottom:1.5rem; }
    .badge::before { content:'â—'; font-size:.5rem; }
    h1 { font-family:'Syne',sans-serif; font-size:clamp(2.5rem,5vw,4rem); font-weight:800; line-height:1.1; margin-bottom:1.2rem; }
    h1 em { font-style:normal; color:var(--cyan); }
    .hero p { font-size:1.1rem; color:rgba(255,255,255,.65); line-height:1.7; max-width:480px; margin-bottom:2.5rem; }
    .hero-actions { display:flex; gap:1rem; flex-wrap:wrap; }
    .btn-primary { background:var(--cyan); color:var(--navy); padding:.85rem 2rem; border-radius:8px; font-weight:700; font-size:1rem; text-decoration:none; transition:all .2s; }
    .btn-primary:hover { background:#00b5bf; transform:translateY(-2px); box-shadow:0 8px 24px rgba(0,201,212,.35); }
    .btn-ghost { border:1px solid rgba(255,255,255,.25); color:var(--white); padding:.85rem 2rem; border-radius:8px; font-weight:500; font-size:1rem; text-decoration:none; transition:all .2s; }
    .btn-ghost:hover { border-color:var(--cyan); color:var(--cyan); }

    /* â”€â”€â”€ STATS â”€â”€â”€ */
    .stats { background:rgba(0,201,212,.06); border-top:1px solid rgba(0,201,212,.12); border-bottom:1px solid rgba(0,201,212,.12); padding:2.5rem 6%; display:flex; justify-content:center; gap:4rem; flex-wrap:wrap; }
    .stat { text-align:center; }
    .stat-num { font-family:'Syne',sans-serif; font-size:2.2rem; font-weight:800; color:var(--cyan); display:block; }
    .stat-label { font-size:.85rem; color:rgba(255,255,255,.55); }

    /* â”€â”€â”€ SERVICES â”€â”€â”€ */
    .section { padding:5rem 6%; }
    .section-tag { font-size:.75rem; font-weight:700; letter-spacing:2px; color:var(--cyan); text-transform:uppercase; margin-bottom:.75rem; }
    h2 { font-family:'Syne',sans-serif; font-size:clamp(1.8rem,3vw,2.8rem); font-weight:800; margin-bottom:1rem; }
    .services-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:1.5rem; margin-top:3rem; }
    .service-card { background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:2rem; transition:all .25s; }
    .service-card:hover { background:rgba(0,201,212,.06); border-color:rgba(0,201,212,.3); transform:translateY(-4px); }
    .service-icon { font-size:2rem; margin-bottom:1rem; }
    .service-card h3 { font-family:'Syne',sans-serif; font-size:1.1rem; margin-bottom:.5rem; }
    .service-card p { font-size:.875rem; color:rgba(255,255,255,.55); line-height:1.6; }

    /* â”€â”€â”€ FORMS SECTION â”€â”€â”€ */
    .forms-section { background:var(--light); padding:5rem 6%; }
    .forms-section h2 { color:var(--text); }
    .forms-section .section-tag { color:#0891b2; }
    .forms-section > p { color:var(--gray); margin-bottom:3rem; max-width:520px; }
    .forms-grid { display:grid; grid-template-columns:1fr 1fr; gap:2rem; }
    @media(max-width:768px){ .forms-grid { grid-template-columns:1fr; } }

    /* â”€â”€â”€ FORM CARDS â”€â”€â”€ */
    .form-card { background:var(--white); border-radius:16px; padding:2.5rem; box-shadow:0 4px 24px rgba(0,0,0,.07); position:relative; overflow:hidden; }
    .form-card::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; }
    .form-card.quote::before { background:linear-gradient(90deg,#00c9d4,#0891b2); }
    .form-card.appt::before { background:linear-gradient(90deg,#f59e0b,#ef4444); }
    .form-card h3 { font-family:'Syne',sans-serif; font-size:1.4rem; font-weight:800; color:var(--text); margin-bottom:.4rem; }
    .form-card > p { font-size:.875rem; color:var(--gray); margin-bottom:1.8rem; }

    .form-row { margin-bottom:1.2rem; }
    .form-row label { display:block; font-size:.8rem; font-weight:500; color:var(--text); margin-bottom:.4rem; }
    .form-row input, .form-row select, .form-row textarea {
      width:100%; padding:.75rem 1rem; border:1.5px solid #e2e8f0; border-radius:8px;
      font-family:'DM Sans',sans-serif; font-size:.9rem; color:var(--text); background:var(--white);
      transition:border-color .2s, box-shadow .2s; outline:none;
    }
    .form-row input:focus, .form-row select:focus, .form-row textarea:focus {
      border-color:#00c9d4; box-shadow:0 0 0 3px rgba(0,201,212,.1);
    }
    .form-row textarea { resize:vertical; min-height:80px; }
    .form-grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:1rem; }
    @media(max-width:480px){ .form-grid-2 { grid-template-columns:1fr; } }

    .submit-btn { width:100%; padding:.9rem; border:none; border-radius:8px; font-family:'DM Sans',sans-serif; font-size:.95rem; font-weight:700; cursor:pointer; transition:all .2s; margin-top:.5rem; }
    .submit-btn.cyan { background:var(--cyan); color:var(--navy); }
    .submit-btn.cyan:hover { background:#00b5bf; transform:translateY(-1px); box-shadow:0 6px 20px rgba(0,201,212,.35); }
    .submit-btn.amber { background:var(--amber); color:var(--white); }
    .submit-btn.amber:hover { background:#d97706; transform:translateY(-1px); box-shadow:0 6px 20px rgba(245,158,11,.35); }
    .submit-btn:disabled { opacity:.55; cursor:not-allowed; transform:none !important; box-shadow:none !important; }

    /* â”€â”€â”€ CALENDAR STEPS â”€â”€â”€ */
    .cal-step { display:none; }
    .cal-step.active { display:block; }

    /* Progress indicator */
    .step-indicator { display:flex; align-items:center; gap:.5rem; margin-bottom:1.5rem; }
    .step-dot { width:28px; height:28px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:.75rem; font-weight:700; flex-shrink:0; }
    .step-dot.done { background:#00c9d4; color:var(--navy); }
    .step-dot.active { background:#f59e0b; color:var(--white); }
    .step-dot.pending { background:#e2e8f0; color:#94a3b8; }
    .step-line { flex:1; height:2px; background:#e2e8f0; }
    .step-line.done { background:#00c9d4; }
    .step-label { font-size:.7rem; color:var(--gray); margin-top:.25rem; display:none; }

    /* Date strip */
    .date-strip { display:flex; gap:.6rem; overflow-x:auto; padding-bottom:.6rem; margin-bottom:1.5rem; scroll-snap-type:x mandatory; }
    .date-strip::-webkit-scrollbar { height:4px; }
    .date-strip::-webkit-scrollbar-thumb { background:#e2e8f0; border-radius:4px; }
    .date-btn {
      flex-shrink:0; padding:.65rem .85rem; border:1.5px solid #e2e8f0; border-radius:10px;
      background:var(--white); cursor:pointer; text-align:center; min-width:58px;
      transition:all .15s; font-family:'DM Sans',sans-serif; scroll-snap-align:start;
    }
    .date-btn .d-day { font-size:.65rem; color:var(--gray); text-transform:uppercase; letter-spacing:.5px; display:block; }
    .date-btn .d-num { font-size:1.25rem; font-weight:700; color:var(--text); display:block; line-height:1.3; }
    .date-btn .d-mon { font-size:.65rem; color:var(--gray); display:block; }
    .date-btn:hover { border-color:#00c9d4; background:#f0fdfe; }
    .date-btn.selected { border-color:#f59e0b; background:#fffbeb; }
    .date-btn.selected .d-num { color:#92400e; }

    /* Time slots */
    .slots-section { margin-bottom:1.2rem; }
    .slots-label { font-size:.78rem; font-weight:600; color:var(--text); margin-bottom:.65rem; letter-spacing:.3px; text-transform:uppercase; }
    .slots-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:.55rem; min-height:90px; }
    .slot-btn {
      padding:.6rem .3rem; border:1.5px solid #e2e8f0; border-radius:8px;
      background:var(--white); cursor:pointer; font-family:'DM Sans',sans-serif;
      font-size:.82rem; font-weight:500; color:var(--text);
      transition:all .15s; text-align:center; line-height:1.2;
    }
    .slot-btn:hover:not(.booked) { border-color:#f59e0b; background:#fffbeb; }
    .slot-btn.selected { border-color:#f59e0b; background:#fffbeb; color:#92400e; font-weight:700; }
    .slot-btn.booked { background:#f8fafc; color:#cbd5e1; cursor:not-allowed; text-decoration:line-through; border-color:#f1f5f9; }

    .slots-placeholder { grid-column:1/-1; text-align:center; color:var(--gray); font-size:.85rem; padding:1.25rem 0; }
    .slots-loading-el { grid-column:1/-1; text-align:center; padding:1.25rem 0; }
    .slots-loading-el .dot-pulse { display:inline-flex; gap:4px; align-items:center; }
    .dot-pulse span { width:6px; height:6px; border-radius:50%; background:#f59e0b; animation:pulse 1.2s ease-in-out infinite; }
    .dot-pulse span:nth-child(2) { animation-delay:.2s; }
    .dot-pulse span:nth-child(3) { animation-delay:.4s; }
    @keyframes pulse { 0%,80%,100%{transform:scale(.6);opacity:.4} 40%{transform:scale(1);opacity:1} }

    /* Summary banner */
    .selected-summary {
      display:none; background:#fffbeb; border:1px solid #fcd34d; border-radius:8px;
      padding:.8rem 1rem; margin-bottom:1rem; font-size:.85rem; color:#92400e;
    }
    .selected-summary strong { font-weight:700; }

    /* Back button */
    .step-back { background:none; border:none; color:var(--gray); font-size:.82rem; cursor:pointer; padding:0; margin-bottom:1.25rem; font-family:'DM Sans',sans-serif; display:flex; align-items:center; gap:.3rem; }
    .step-back:hover { color:var(--text); }

    /* Success state */
    .success-msg { text-align:center; padding:2rem 1.5rem; background:#ecfdf5; border:1px solid #6ee7b7; border-radius:12px; color:#065f46; }
    .success-msg .check { font-size:2.8rem; margin-bottom:.75rem; }
    .success-msg h4 { font-family:'Syne',sans-serif; font-size:1.25rem; margin-bottom:.5rem; }
    .success-msg p { font-size:.875rem; line-height:1.6; }
    .success-simple { display:none; text-align:center; padding:1.5rem; background:#ecfdf5; border:1px solid #6ee7b7; border-radius:8px; color:#065f46; font-weight:500; }

    /* Errors */
    .error-msg { display:none; background:#fef2f2; border:1px solid #fca5a5; border-radius:8px; padding:.75rem 1rem; font-size:.85rem; color:#991b1b; margin-top:.75rem; }

    /* Spinner */
    .spinner { display:inline-block; width:15px; height:15px; border:2px solid rgba(255,255,255,.4); border-top-color:currentColor; border-radius:50%; animation:spin .6s linear infinite; vertical-align:middle; margin-right:6px; }
    .submit-btn.cyan .spinner { border-top-color:var(--navy); }
    @keyframes spin { to { transform:rotate(360deg); } }

    /* â”€â”€â”€ FOOTER â”€â”€â”€ */
    footer { padding:3rem 6%; text-align:center; border-top:1px solid rgba(255,255,255,.06); }
    footer p { color:rgba(255,255,255,.35); font-size:.85rem; }
    footer .logo { display:inline-block; margin-bottom:.75rem; }

    @keyframes fadeUp { from { opacity:0; transform:translateY(24px); } to { opacity:1; transform:translateY(0); } }
    .hero-content > * { animation:fadeUp .7s ease both; }
    .hero-content > *:nth-child(1) { animation-delay:.1s; }
    .hero-content > *:nth-child(2) { animation-delay:.25s; }
    .hero-content > *:nth-child(3) { animation-delay:.4s; }
    .hero-content > *:nth-child(4) { animation-delay:.55s; }
  </style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="logo">Air<span>Pro</span></div>
  <ul class="nav-links">
    <li><a href="#services">Services</a></li>
    <li><a href="#quote">Free Quote</a></li>
    <li><a href="#appointment">Book Appointment</a></li>
  </ul>
  <a href="tel:+18005551234" class="nav-cta">ğŸ“ (800) 555-1234</a>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-content">
    <div class="badge">Licensed &amp; Insured Â· Same-Day Service</div>
    <h1>Expert HVAC for <em>Every Season</em></h1>
    <p>Heating, cooling, and air quality solutions for homes and businesses. Fast response, transparent pricing, guaranteed results.</p>
    <div class="hero-actions">
      <a href="#quote" class="btn-primary">Get Free Quote</a>
      <a href="#appointment" class="btn-ghost">Book Appointment</a>
    </div>
  </div>
</section>

<!-- STATS -->
<div class="stats">
  <div class="stat"><span class="stat-num">2,400+</span><span class="stat-label">Happy Customers</span></div>
  <div class="stat"><span class="stat-num">15 Yrs</span><span class="stat-label">Experience</span></div>
  <div class="stat"><span class="stat-num">4.9â˜…</span><span class="stat-label">Average Rating</span></div>
  <div class="stat"><span class="stat-num">24/7</span><span class="stat-label">Emergency Service</span></div>
</div>

<!-- SERVICES -->
<section class="section" id="services">
  <div class="section-tag">What We Do</div>
  <h2>Full HVAC Solutions</h2>
  <div class="services-grid">
    <div class="service-card"><div class="service-icon">â„ï¸</div><h3>AC Installation &amp; Repair</h3><p>Central air, mini-splits, and commercial cooling systems installed and serviced by certified technicians.</p></div>
    <div class="service-card"><div class="service-icon">ğŸ”¥</div><h3>Heating Systems</h3><p>Furnace repair, heat pump installation, and boiler maintenance to keep you warm all winter.</p></div>
    <div class="service-card"><div class="service-icon">ğŸŒ¬ï¸</div><h3>Air Quality</h3><p>Duct cleaning, filtration systems, and humidity control for a healthier indoor environment.</p></div>
    <div class="service-card"><div class="service-icon">ğŸ”§</div><h3>Preventive Maintenance</h3><p>Seasonal tune-ups and service plans that extend system life and cut energy costs.</p></div>
  </div>
</section>

<!-- â”€â”€â”€ FORMS â”€â”€â”€ -->
<section class="forms-section" id="quote">
  <div class="section-tag">Get Started Today</div>
  <h2>Let's Get You Comfortable</h2>
  <p>Fill out either form â€” we'll reach out within 2 hours during business hours.</p>

  <div class="forms-grid">

    <!-- FREE QUOTE FORM -->
    <div class="form-card quote">
      <h3>ğŸ Free Quote</h3>
      <p>Tell us what you need â€” we'll send a no-obligation estimate.</p>
      <form id="quoteForm">
        <div class="form-row"><label>Full Name *</label><input type="text" id="q-name" placeholder="Jane Smith" required /></div>
        <div class="form-grid-2">
          <div class="form-row"><label>Phone *</label><input type="tel" id="q-phone" placeholder="(555) 000-0000" required /></div>
          <div class="form-row"><label>Email</label><input type="email" id="q-email" placeholder="jane@email.com" /></div>
        </div>
        <div class="form-row">
          <label>Service Needed *</label>
          <select id="q-service" required>
            <option value="">Select a service...</option>
            <option>AC Installation</option><option>AC Repair</option>
            <option>Heating / Furnace</option><option>Air Quality / Ducts</option>
            <option>Maintenance Plan</option><option>Other</option>
          </select>
        </div>
        <div class="form-row"><label>Brief Description</label><textarea id="q-desc" placeholder="Describe the issue or project..."></textarea></div>
        <button type="submit" class="submit-btn cyan" id="quoteBtn">Get My Free Quote â†’</button>
      </form>
      <div class="success-simple" id="quoteSuccess">âœ… Thanks! We'll send your quote within 2 hours.</div>
      <div class="error-msg" id="quoteError">âš ï¸ Something went wrong. Please call us directly at (800) 555-1234.</div>
    </div>

    <!-- APPOINTMENT CARD -->
    <div class="form-card appt" id="appointment">
      <h3>ğŸ“… Book Appointment</h3>
      <p>Live calendar â€” pick an open slot and confirm instantly.</p>

      <!-- STEP 1: Info -->
      <div id="step1" class="cal-step active">
        <!-- Progress -->
        <div class="step-indicator">
          <div class="step-dot active">1</div>
          <div class="step-line"></div>
          <div class="step-dot pending">2</div>
          <div class="step-line"></div>
          <div class="step-dot pending">3</div>
        </div>
        <div class="form-row"><label>Full Name *</label><input type="text" id="a-name" placeholder="John Doe" /></div>
        <div class="form-grid-2">
          <div class="form-row"><label>Phone *</label><input type="tel" id="a-phone" placeholder="(555) 000-0000" /></div>
          <div class="form-row"><label>Email</label><input type="email" id="a-email" placeholder="john@email.com" /></div>
        </div>
        <div class="form-row">
          <label>Service Type *</label>
          <select id="a-service">
            <option value="">Select a service...</option>
            <option>Emergency Repair</option><option>AC Service</option>
            <option>Heating Service</option><option>Annual Tune-Up</option>
            <option>New Installation</option><option>Other</option>
          </select>
        </div>
        <button type="button" class="submit-btn amber" onclick="goToStep2()">Choose Date &amp; Time â†’</button>
      </div>

      <!-- STEP 2: Calendar -->
      <div id="step2" class="cal-step">
        <div class="step-indicator">
          <div class="step-dot done">âœ“</div>
          <div class="step-line done"></div>
          <div class="step-dot active">2</div>
          <div class="step-line"></div>
          <div class="step-dot pending">3</div>
        </div>
        <button class="step-back" onclick="goToStep1()">â† Back</button>

        <div class="form-row" style="margin-bottom:.6rem;"><label>Select a Date</label></div>
        <div class="date-strip" id="dateStrip"></div>

        <div class="slots-section">
          <div class="slots-label" id="slotsLabel">Available Times</div>
          <div class="slots-grid" id="slotsGrid">
            <div class="slots-placeholder">ğŸ‘† Select a date above</div>
          </div>
        </div>

        <div class="selected-summary" id="selectedSummary">
          ğŸ“… Selected: <strong id="summaryText"></strong>
        </div>

        <button type="button" class="submit-btn amber" id="confirmBtn" onclick="goToStep3()" disabled>Confirm Appointment â†’</button>
        <div class="error-msg" id="apptError">âš ï¸ Booking failed. Please call (800) 555-1234 directly.</div>
      </div>

      <!-- STEP 3: Success -->
      <div id="step3" class="cal-step">
        <div class="success-msg">
          <div class="check">ğŸ‰</div>
          <h4>Appointment Confirmed!</h4>
          <p id="confirmDetail">Your appointment has been scheduled.</p>
          <p style="margin-top:.6rem; color:#047857;">A Google Calendar invite will be sent to your email.</p>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="logo">Air<span>Pro</span> HVAC</div>
  <p>Licensed Â· Insured Â· 5-Star Rated Â· Serving the Greater Area Since 2009</p>
  <p style="margin-top:.5rem;">Â© 2025 AirPro HVAC. All rights reserved.</p>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  âš™ï¸  CONFIG â€” replace with your n8n webhook URLs
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CONFIG = {
  // Webhook 1: GET /hvac-get-slots?date=YYYY-MM-DD
  // Returns: { slots: [{ time:"09:00", label:"9:00 AM", available:true }, ...] }
  GET_SLOTS_URL:  'https://YOUR_N8N_HOST/webhook/hvac-get-slots',

  // Webhook 2: POST /hvac-book-appointment
  // Body: { name, phone, email, service, date, time, label, duration_minutes }
  // Returns: { success: true, eventId: "..." }
  BOOK_APPT_URL:  'https://YOUR_N8N_HOST/webhook/hvac-book-appointment',

  // Webhook 3: POST /hvac-quote
  // Body: { name, phone, email, service, notes }
  QUOTE_URL:      'https://YOUR_N8N_HOST/webhook/hvac-quote',

  // Appointment duration in minutes
  SLOT_DURATION:  60,

  // Days ahead to show in date strip
  DAYS_AHEAD:     8,
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  State
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let selectedDate = null;   // "YYYY-MM-DD"
let selectedSlot = null;   // { time, label, available }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUOTE FORM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('quoteForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const btn = document.getElementById('quoteBtn');
  const errEl = document.getElementById('quoteError');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span>Sending...';
  errEl.style.display = 'none';

  try {
    const res = await fetch(CONFIG.QUOTE_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name:    document.getElementById('q-name').value,
        phone:   document.getElementById('q-phone').value,
        email:   document.getElementById('q-email').value,
        service: document.getElementById('q-service').value,
        notes:   document.getElementById('q-desc').value,
      }),
    });
    if (!res.ok) throw new Error();
    document.getElementById('quoteForm').style.display = 'none';
    document.getElementById('quoteSuccess').style.display = 'block';
  } catch {
    errEl.style.display = 'block';
    btn.disabled = false;
    btn.innerHTML = 'Get My Free Quote â†’';
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STEP NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function goToStep1() {
  show('step1'); hide('step2'); hide('step3');
  selectedDate = null; selectedSlot = null;
}

function goToStep2() {
  const name    = v('a-name');
  const phone   = v('a-phone');
  const service = v('a-service');
  if (!name || !phone || !service) {
    alert('Please fill in Name, Phone, and Service Type to continue.');
    return;
  }
  hide('step1'); show('step2'); hide('step3');
  buildDateStrip();
}

async function goToStep3() {
  if (!selectedDate || !selectedSlot) return;

  const btn = document.getElementById('confirmBtn');
  const errEl = document.getElementById('apptError');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span>Booking...';
  errEl.style.display = 'none';

  try {
    const res = await fetch(CONFIG.BOOK_APPT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name:             v('a-name'),
        phone:            v('a-phone'),
        email:            v('a-email'),
        service:          v('a-service'),
        date:             selectedDate,
        time:             selectedSlot.time,
        label:            selectedSlot.label,
        duration_minutes: CONFIG.SLOT_DURATION,
      }),
    });
    if (!res.ok) throw new Error();

    hide('step1'); hide('step2'); show('step3');
    document.getElementById('confirmDetail').textContent =
      `Scheduled for ${formatDateDisplay(selectedDate)} at ${selectedSlot.label} Â· ${v('a-service')}`;
  } catch {
    errEl.style.display = 'block';
    btn.disabled = false;
    btn.innerHTML = 'Confirm Appointment â†’';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DATE STRIP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildDateStrip() {
  const strip = document.getElementById('dateStrip');
  strip.innerHTML = '';
  const DAYS  = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  const MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const today = new Date();
  let count = 0;

  for (let i = 0; count < CONFIG.DAYS_AHEAD; i++) {
    const d = new Date(today);
    d.setDate(today.getDate() + i);
    if (d.getDay() === 0) continue; // skip Sundays
    count++;

    const btn = document.createElement('button');
    btn.className = 'date-btn';
    btn.innerHTML = `<span class="d-day">${DAYS[d.getDay()]}</span>
                     <span class="d-num">${d.getDate()}</span>
                     <span class="d-mon">${MONTHS[d.getMonth()]}</span>`;
    btn.dataset.iso = formatDate(d);
    btn.addEventListener('click', () => onDateSelect(btn, d));
    strip.appendChild(btn);
  }
}

function onDateSelect(btn, dateObj) {
  document.querySelectorAll('.date-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  selectedDate = btn.dataset.iso;
  selectedSlot = null;
  document.getElementById('confirmBtn').disabled = true;
  document.getElementById('selectedSummary').style.display = 'none';
  document.getElementById('apptError').style.display = 'none';
  document.getElementById('slotsLabel').textContent = `Available Times â€” ${formatDateDisplay(selectedDate)}`;
  fetchSlots(selectedDate);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  FETCH SLOTS FROM N8N
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchSlots(dateStr) {
  const grid = document.getElementById('slotsGrid');
  grid.innerHTML = `<div class="slots-loading-el">
    <div class="dot-pulse"><span></span><span></span><span></span></div>
    <p style="margin-top:.5rem;font-size:.8rem;color:#64748b;">Checking calendar...</p>
  </div>`;

  try {
    const res = await fetch(`${CONFIG.GET_SLOTS_URL}?date=${dateStr}`);
    if (!res.ok) throw new Error();
    const data = await res.json();
    renderSlots(data.slots || []);
  } catch {
    grid.innerHTML = '<div class="slots-placeholder">âš ï¸ Could not load slots. Try another date or call us.</div>';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  RENDER SLOTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderSlots(slots) {
  const grid = document.getElementById('slotsGrid');
  grid.innerHTML = '';

  if (!slots.length) {
    grid.innerHTML = '<div class="slots-placeholder">No open slots on this day. Please choose another date.</div>';
    return;
  }

  slots.forEach(slot => {
    const btn = document.createElement('button');
    btn.className = 'slot-btn' + (!slot.available ? ' booked' : '');
    btn.textContent = slot.label;
    if (!slot.available) { btn.title = 'Already booked'; }

    btn.addEventListener('click', () => {
      if (!slot.available) return;
      document.querySelectorAll('.slot-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      selectedSlot = slot;
      document.getElementById('summaryText').textContent = `${formatDateDisplay(selectedDate)} Â· ${slot.label}`;
      document.getElementById('selectedSummary').style.display = 'block';
      document.getElementById('confirmBtn').disabled = false;
    });

    grid.appendChild(btn);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function v(id) { return document.getElementById(id).value.trim(); }
function show(id) { document.getElementById(id).classList.add('active'); }
function hide(id) { document.getElementById(id).classList.remove('active'); }

function formatDate(d) {
  return `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
}

function formatDateDisplay(iso) {
  const [y, m, d] = iso.split('-').map(Number);
  return new Date(y, m-1, d).toLocaleDateString('en-US', { weekday:'long', month:'long', day:'numeric' });
}
</script>
</body>
</html>
